<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Glamour Beauty - Maquillaje Profesional</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <nav>
    <div class="logo">Glamour Beauty</div>
    <ul>
      <li><a href="#" data-section="inicio" class="nav-link">Inicio</a></li>
      <li><a href="#" data-section="productos" class="nav-link">Productos</a></li>
      <li><a href="#" data-section="tips" class="nav-link">Tips</a></li>
      <li><a href="#" data-section="comentarios" class="nav-link">Comentarios</a></li>
      <li><a href="#" data-section="login" class="nav-link">Iniciar sesiÃ³n</a></li>
    </ul>
  </nav>

  <main>
    <section id="inicio" class="section">
      <div class="hero">
        <div class="hero-text">
          <h1>Bienvenida a Glamour Beauty</h1>
          <p>Tu destino para maquillaje profesional, productos exclusivos y los mejores tips de belleza.</p>
          <button class="cta-btn" id="explora-productos">Explora Productos</button>
        </div>
        <img src="https://images.unsplash.com/photo-1517841905240-472988babdf9?auto=format&fit=crop&w=800&q=80" alt="Maquillaje Glamour" class="hero-img">
      </div>
    </section>

    <section id="productos" class="section" style="display:none;">
      <h1>Nuestros Productos</h1>
      <div class="productos-grid" id="productos-grid"></div>
      <div id="admin-productos" style="display:none;">
        <h2>Agregar producto</h2>
        <form id="form-agregar-producto">
          <input type="text" id="nuevo-nombre" placeholder="Nombre" required>
          <input type="text" id="nuevo-descripcion" placeholder="DescripciÃ³n" required>
          <input type="url" id="nuevo-imagen" placeholder="URL de imagen" required>
          <button type="submit">Agregar</button>
        </form>
      </div>
    </section>

    <section id="tips" class="section" style="display:none;">
      <h1>Tips de Maquillaje</h1>
      <div class="tips-list" id="tips-list"></div>
    </section>

    <section id="login" class="section" style="display:none;">
      <h1>Iniciar sesiÃ³n</h1>
      <form id="login-form" autocomplete="off">
        <label for="login-usuario">Usuario:</label>
        <input type="text" id="login-usuario" required>
        <label for="login-password">ContraseÃ±a:</label>
        <div style="position:relative;">
          <input type="password" id="login-password" required>
          <button type="button" id="toggle-login-password" style="position:absolute; right:5px; top:5px;">ğŸ‘ï¸</button>
        </div>
        <button type="submit">Entrar</button>
        <div style="margin-top: 12px; text-align: center;">
          <a href="#" id="registrate-link">Registrarte</a> |
          <a href="#" id="olvide-link">Â¿Olvidaste tu contraseÃ±a?</a>
        </div>
      </form>
      <div id="login-error" class="alert error" style="display:none;">
        Usuario o contraseÃ±a incorrectos.
      </div>
    </section>

    <section id="comentarios" class="section" style="display:none;">
      <h1>Deja tu comentario</h1>
      <form id="comentario-form" autocomplete="off">
        <label for="comentario-nombre">Nombre:</label>
        <input type="text" id="comentario-nombre" required>
        <label for="comentario-texto">Comentario:</label>
        <textarea id="comentario-texto" required></textarea>
        <button type="submit">Publicar</button>
      </form>
    </section>

    <section id="info-usuario" class="section" style="display:none;">
      <h2>Mi perfil</h2>
      <ul id="datos-usuario"></ul>
      <button id="logout-btn">Cerrar sesiÃ³n</button>
    </section>
  </main>

  <footer>
    <p>&copy; 2025 Glamour Beauty. Todos los derechos reservados.</p>
  </footer>

  <script src="app.js"></script>

  <!-- Modal de registro -->
  <div id="modal-registro" class="modal" style="display:none;">
    <div class="modal-content registro-horizontal">
      <span class="close" id="cerrar-modal">&times;</span>
      <form id="registro-form" class="registro-form-horizontal">
        <div class="registro-col">
          <h2><span style="color:#c2185b;">Registro</span> de usuario</h2>
          <div class="input-group">
            <label for="reg-nombre"><span class="icon">ğŸ‘¤</span> Nombre completo</label>
            <input type="text" id="reg-nombre" required>
          </div>
          <div class="input-group">
            <label for="reg-fecha"><span class="icon">ğŸ“…</span> Fecha de nacimiento</label>
            <input type="date" id="reg-fecha" required>
          </div>
          <div class="input-group">
            <label for="reg-edad"><span class="icon">ğŸ‚</span> Edad</label>
            <input type="number" id="reg-edad" min="1" required>
          </div>
          <div class="input-group">
            <label for="reg-usuario"><span class="icon">ğŸ†”</span> Usuario</label>
            <input type="text" id="reg-usuario" required>
          </div>
        </div>
        <div class="registro-col">
          <div class="input-group">
            <label for="reg-password"><span class="icon">ğŸ”’</span> ContraseÃ±a</label>
            <div class="input-password">
              <input type="password" id="reg-password" required>
              <button type="button" id="toggle-reg-password" class="toggle-eye">ğŸ‘ï¸</button>
            </div>
          </div>
          <div class="input-group">
            <label for="reg-password2"><span class="icon">ğŸ”’</span> Confirmar contraseÃ±a</label>
            <div class="input-password">
              <input type="password" id="reg-password2" required>
              <button type="button" id="toggle-reg-password2" class="toggle-eye">ğŸ‘ï¸</button>
            </div>
          </div>
          <div class="input-group">
            <label for="pregunta1"><span class="icon">â“</span> Pregunta de seguridad 1</label>
            <select id="pregunta1" required>
              <option value="">Selecciona una pregunta</option>
              <option value="Â¿CuÃ¡l es el nombre de tu primera mascota?">Â¿CuÃ¡l es el nombre de tu primera mascota?</option>
              <option value="Â¿En quÃ© ciudad naciste?">Â¿En quÃ© ciudad naciste?</option>
              <option value="Â¿CuÃ¡l es tu comida favorita?">Â¿CuÃ¡l es tu comida favorita?</option>
              <option value="Â¿CÃ³mo se llama tu mejor amigo de la infancia?">Â¿CÃ³mo se llama tu mejor amigo de la infancia?</option>
            </select>
            <input type="text" id="respuesta1" placeholder="Respuesta" required>
          </div>
          <div class="input-group">
            <label for="pregunta2"><span class="icon">â“</span> Pregunta de seguridad 2</label>
            <select id="pregunta2" required>
              <option value="">Selecciona una pregunta</option>
              <option value="Â¿CuÃ¡l es el nombre de tu primera mascota?">Â¿CuÃ¡l es el nombre de tu primera mascota?</option>
              <option value="Â¿En quÃ© ciudad naciste?">Â¿En quÃ© ciudad naciste?</option>
              <option value="Â¿CuÃ¡l es tu comida favorita?">Â¿CuÃ¡l es tu comida favorita?</option>
              <option value="Â¿CÃ³mo se llama tu mejor amigo de la infancia?">Â¿CÃ³mo se llama tu mejor amigo de la infancia?</option>
            </select>
            <input type="text" id="respuesta2" placeholder="Respuesta" required>
          </div>
          <button type="submit" class="btn-registro">Registrar</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Modal de recuperaciÃ³n de contraseÃ±a -->
  <div id="modal-recuperar" class="modal" style="display:none;">
    <div class="modal-content registro-horizontal">
      <span class="close" id="cerrar-modal-recuperar">&times;</span>
      <form id="recuperar-form" class="registro-form-horizontal">
        <div class="registro-col">
          <h2><span style="color:#c2185b;">Recuperar</span> contraseÃ±a</h2>
          <div class="input-group">
            <label for="rec-usuario"><span class="icon">ğŸ†”</span> Usuario</label>
            <input type="text" id="rec-usuario" required>
          </div>
          <button type="button" id="ver-preguntas" class="btn-registro" style="margin-top:12px;">Ver preguntas</button>
        </div>
        <div class="registro-col" id="preguntas-seguridad" style="display:none;">
          <div class="input-group">
            <label id="label-pregunta1"></label>
            <input type="text" id="respuesta1-recuperar" placeholder="Respuesta 1" required>
          </div>
          <div class="input-group">
            <label id="label-pregunta2"></label>
            <input type="text" id="respuesta2-recuperar" placeholder="Respuesta 2" required>
          </div>
          <div class="input-group">
            <label for="nueva-password"><span class="icon">ğŸ”’</span> Nueva contraseÃ±a</label>
            <div class="input-password">
              <input type="password" id="nueva-password" required>
              <button type="button" id="toggle-nueva-password" class="toggle-eye">ğŸ‘ï¸</button>
            </div>
          </div>
          <button type="submit" class="btn-registro">Cambiar contraseÃ±a</button>
        </div>
      </form>
      <div id="recuperar-error" class="alert error" style="display:none;">Datos incorrectos.</div>
      <div id="recuperar-exito" class="alert success" style="display:none;">Â¡ContraseÃ±a cambiada!</div>
    </div>
  </div>
</body>
</html>

// --- NAVEGACIÃ“N ENTRE SECCIONES ---
document.querySelectorAll('nav ul li a[data-section]').forEach(link => {
  link.addEventListener('click', function(e) {
    e.preventDefault();
    const sectionId = this.getAttribute('data-section');
    if (sectionId) {
      document.querySelectorAll('.section').forEach(sec => sec.style.display = 'none');
      const section = document.getElementById(sectionId);
      if (section) section.style.display = 'block';
      document.querySelectorAll('nav ul li a').forEach(l => l.classList.remove('active'));
      this.classList.add('active');
      history.pushState({section: sectionId}, '', '#' + sectionId);
    }
  });
});

window.addEventListener('popstate', function(e) {
  const sectionId = (e.state && e.state.section) || location.hash.replace('#', '') || 'inicio';
  document.querySelectorAll('.section').forEach(sec => sec.style.display = 'none');
  const section = document.getElementById(sectionId);
  if (section) section.style.display = 'block';
});

// --- MODALES REGISTRO Y RECUPERAR ---
document.addEventListener('DOMContentLoaded', function() {
  // Mostrar modal de registro
  const registrateLink = document.getElementById('registrate-link');
  const modalRegistro = document.getElementById('modal-registro');
  const cerrarModal = document.getElementById('cerrar-modal');
  if (registrateLink && modalRegistro) {
    registrateLink.addEventListener('click', function(e) {
      e.preventDefault();
      modalRegistro.style.display = 'flex';
    });
  }
  if (cerrarModal && modalRegistro) {
    cerrarModal.addEventListener('click', function() {
      modalRegistro.style.display = 'none';
    });
  }

  // Mostrar modal de recuperaciÃ³n
  const olvideLink = document.getElementById('olvide-link');
  const modalRecuperar = document.getElementById('modal-recuperar');
  const cerrarModalRecuperar = document.getElementById('cerrar-modal-recuperar');
  if (olvideLink && modalRecuperar) {
    olvideLink.addEventListener('click', function(e) {
      e.preventDefault();
      modalRecuperar.style.display = 'flex';
      document.getElementById('recuperar-form').reset();
      document.getElementById('preguntas-seguridad').style.display = 'none';
      document.getElementById('recuperar-error').style.display = 'none';
      document.getElementById('recuperar-exito').style.display = 'none';
    });
  }
  if (cerrarModalRecuperar && modalRecuperar) {
    cerrarModalRecuperar.addEventListener('click', function() {
      modalRecuperar.style.display = 'none';
    });
  }

  // Mostrar/ocultar contraseÃ±a en login
  const loginPassword = document.getElementById('login-password');
  const toggleLoginPassword = document.getElementById('toggle-login-password');
  if (loginPassword && toggleLoginPassword) {
    toggleLoginPassword.addEventListener('click', function() {
      if (loginPassword.type === 'password') {
        loginPassword.type = 'text';
        toggleLoginPassword.textContent = 'ğŸ™ˆ';
      } else {
        loginPassword.type = 'password';
        toggleLoginPassword.textContent = 'ğŸ‘ï¸';
      }
    });
  }

  // Mostrar/ocultar contraseÃ±a en registro
  const regPassword = document.getElementById('reg-password');
  const toggleRegPassword = document.getElementById('toggle-reg-password');
  if (regPassword && toggleRegPassword) {
    toggleRegPassword.addEventListener('click', function() {
      if (regPassword.type === 'password') {
        regPassword.type = 'text';
        toggleRegPassword.textContent = 'ğŸ™ˆ';
      } else {
        regPassword.type = 'password';
        toggleRegPassword.textContent = 'ğŸ‘ï¸';
      }
    });
  }
  // Mostrar/ocultar confirmar contraseÃ±a
  const regPassword2 = document.getElementById('reg-password2');
  const toggleRegPassword2 = document.getElementById('toggle-reg-password2');
  if (regPassword2 && toggleRegPassword2) {
    toggleRegPassword2.addEventListener('click', function() {
      if (regPassword2.type === 'password') {
        regPassword2.type = 'text';
        toggleRegPassword2.textContent = 'ğŸ™ˆ';
      } else {
        regPassword2.type = 'password';
        toggleRegPassword2.textContent = 'ğŸ‘ï¸';
      }
    });
  }
  // Mostrar/ocultar nueva contraseÃ±a en recuperaciÃ³n
  const nuevaPassword = document.getElementById('nueva-password');
  const toggleNuevaPassword = document.getElementById('toggle-nueva-password');
  if (nuevaPassword && toggleNuevaPassword) {
    toggleNuevaPassword.addEventListener('click', function() {
      if (nuevaPassword.type === 'password') {
        nuevaPassword.type = 'text';
        toggleNuevaPassword.textContent = 'ğŸ™ˆ';
      } else {
        nuevaPassword.type = 'password';
        toggleNuevaPassword.textContent = 'ğŸ‘ï¸';
      }
    });
  }

  const initialSection = location.hash.replace('#', '') || 'inicio';
  document.querySelectorAll('.section').forEach(sec => sec.style.display = 'none');
  const section = document.getElementById(initialSection);
  if (section) section.style.display = 'block';
});

// --- REGISTRO ---
function obtenerUsuarios() {
  return JSON.parse(localStorage.getItem('usuariosGlamour')) || [];
}
function guardarUsuarios(usuarios) {
  localStorage.setItem('usuariosGlamour', JSON.stringify(usuarios));
}
const registroForm = document.getElementById('registro-form');
if (registroForm) {
  registroForm.addEventListener('submit', function(e) {
    e.preventDefault();
    const nombre = document.getElementById('reg-nombre').value.trim();
    const fecha = document.getElementById('reg-fecha').value;
    const edad = document.getElementById('reg-edad').value.trim();
    const usuario = document.getElementById('reg-usuario').value.trim();
    const password = document.getElementById('reg-password').value;
    const password2 = document.getElementById('reg-password2').value;
    const pregunta1 = document.getElementById('pregunta1').value.trim();
    const respuesta1 = document.getElementById('respuesta1').value.trim();
    const pregunta2 = document.getElementById('pregunta2').value.trim();
    const respuesta2 = document.getElementById('respuesta2').value.trim();

    let usuarios = obtenerUsuarios();
    if (usuarios.find(u => u.usuario === usuario)) {
      alert('El usuario ya estÃ¡ registrado. Elige otro nombre de usuario.');
      return;
    }

    // Protocolo de seguridad para la contraseÃ±a
    const errores = [];
    if (password.length < 8) errores.push('â€¢ Al menos 8 caracteres');
    if (!/[A-Z]/.test(password)) errores.push('â€¢ Al menos una mayÃºscula');
    if (!/[a-z]/.test(password)) errores.push('â€¢ Al menos una minÃºscula');
    if (!/[0-9]/.test(password)) errores.push('â€¢ Al menos un nÃºmero');
    if (!/[^A-Za-z0-9]/.test(password)) errores.push('â€¢ Al menos un sÃ­mbolo');

    if (errores.length > 0) {
      alert('La contraseÃ±a debe cumplir con:\n' + errores.join('\n'));
      return;
    }

    if (password !== password2) {
      alert('Las contraseÃ±as no coinciden.');
      return;
    }

    usuarios.push({
      nombre,
      fecha,
      edad,
      usuario,
      password,
      pregunta1,
      respuesta1,
      pregunta2,
      respuesta2
    });
    guardarUsuarios(usuarios);
    alert('Â¡Usuario registrado con Ã©xito!');
    document.getElementById('modal-registro').style.display = 'none';
    registroForm.reset();
    // Mostrar login y rellenar usuario
    document.querySelectorAll('.section').forEach(sec => sec.style.display = 'none');
    const loginSection = document.getElementById('login');
    if (loginSection) loginSection.style.display = 'block';
    document.getElementById('login-usuario').value = usuario;
  });
}

// --- LOGIN ---
const loginForm = document.getElementById('login-form');
const loginError = document.getElementById('login-error');
if (loginForm) {
  loginForm.addEventListener('submit', function(e) {
    e.preventDefault();
    const usuarioInput = document.getElementById('login-usuario').value.trim();
    const password = document.getElementById('login-password').value;
    const usuarios = obtenerUsuarios();
    const user = usuarios.find(u => u.usuario === usuarioInput && u.password === password);
    if (user) {
      loginError.style.display = 'none';
      localStorage.setItem('usuarioActual', usuarioInput);
      mostrarInfoUsuario(usuarioInput);
      document.querySelectorAll('.section').forEach(sec => sec.style.display = 'none');
      document.getElementById('info-usuario').style.display = 'block';
    }
  });
}

// --- MOSTRAR DATOS DEL USUARIO ---
function mostrarInfoUsuario(usuario) {
  const usuarios = obtenerUsuarios();
  const userObj = usuarios.find(u => u.usuario === usuario);
  if (!userObj) return;
  const datos = [
    { label: 'Nombre completo', value: userObj.nombre || '' },
    { label: 'Fecha de nacimiento', value: userObj.fecha || '' },
    { label: 'Edad', value: userObj.edad || '' },
    { label: 'Usuario', value: userObj.usuario || '' }
  ];
  const lista = document.getElementById('datos-usuario');
  if (lista) {
    lista.innerHTML = datos.map(d => `<li><strong>${d.label}:</strong> ${d.value}</li>`).join('');
  }
  const infoSection = document.getElementById('info-usuario');
  if (infoSection) infoSection.style.display = 'block';
}

// --- LOGOUT ---
const logoutBtn = document.getElementById('logout-btn');
if (logoutBtn) {
  logoutBtn.addEventListener('click', function() {
    localStorage.removeItem('usuarioActual');
    document.getElementById('info-usuario').style.display = 'none';
    document.querySelectorAll('.section').forEach(sec => sec.style.display = 'none');
    document.getElementById('login').style.display = 'block';
  });
}

// --- RECUPERAR CONTRASEÃ‘A ---
let usuarioRecuperar = null;
const verPreguntasBtn = document.getElementById('ver-preguntas');
if (verPreguntasBtn) {
  verPreguntasBtn.onclick = function() {
    const usuario = document.getElementById('rec-usuario').value.trim();
    const usuarios = obtenerUsuarios();
    const user = usuarios.find(u => u.usuario === usuario);
    if (user) {
      usuarioRecuperar = user;
      document.getElementById('label-pregunta1').textContent = user.pregunta1;
      document.getElementById('label-pregunta2').textContent = user.pregunta2;
      document.getElementById('preguntas-seguridad').style.display = '';
      document.getElementById('recuperar-error').style.display = 'none';
    } else {
      document.getElementById('preguntas-seguridad').style.display = 'none';
      document.getElementById('recuperar-error').style.display = '';
    }
  };
}

const recuperarForm = document.getElementById('recuperar-form');
if (recuperarForm) {
  recuperarForm.addEventListener('submit', function(e) {
    e.preventDefault();
    if (!usuarioRecuperar) return;
    const r1 = document.getElementById('respuesta1-recuperar').value.trim();
    const r2 = document.getElementById('respuesta2-recuperar').value.trim();
    const nuevaPass = document.getElementById('nueva-password').value;
    if (
      r1 === usuarioRecuperar.respuesta1 &&
      r2 === usuarioRecuperar.respuesta2
    ) {
      let usuarios = obtenerUsuarios();
      usuarios = usuarios.map(u =>
        u.usuario === usuarioRecuperar.usuario
          ? { ...u, password: nuevaPass }
          : u
      );
      guardarUsuarios(usuarios);
      document.getElementById('recuperar-exito').style.display = '';
      document.getElementById('recuperar-error').style.display = 'none';
      this.reset();
      document.getElementById('preguntas-seguridad').style.display = 'none';
      setTimeout(() => {
        document.getElementById('recuperar-exito').style.display = 'none';
        document.getElementById('modal-recuperar').style.display = 'none';
      }, 1500);
    } else {
      document.getElementById('recuperar-error').style.display = '';
    }
  });
}
